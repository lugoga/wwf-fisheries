# Result and Discussion


```{r setup4, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, comment = "")

require(tidyverse)
require(ggpubr)
require(sf)
require(ggspatial)
require(magrittr)
library(kableExtra)
require(cartography)
library(sp)
require(patchwork)
```


```{r}
species = read_csv("../data_update/rumakitu.csv") 

species = species %>% select(1:5)


# species = species %>% 
  # separate(Species, c("Genus", "Species"), sep = " ", remove = FALSE)

# species %>% distinct(Species) %>% arrange(Species)
```

```{r}

dominant.group = bind_rows(
      species%>%
        filter(Species %in% c("Serranidae spp( CEW )","Lutjanus spp( LDW )", "Lutjanus ssp( LTJ )","Red snapper( RDS )","Changu( CHN )", "Carrotomus carolinus( ULG )","Lethrinus borbonicus( LHB )", "Lethrinus harak( LHH )", "Lethrinus lentjan( LHL )", "Lethrinus nebulosus( LHN )", "Lethrinus rubrioperculatus( LHR )", "Lethrinus spp( LH )")) %>%
        mutate(group = "Reef fish"),
      
      species%>%
        filter(Species %in% c("Auxis thazard( FRI )", "Euthynnus affinis( KAW )", "Istiophorus platypterus( SFA )", "Katsuwonus pelamis( SKJ )", "Other tuna( JDR )", "Scomberomorus commerson( COM )", "Scomberomorus guttatus( GUT )", "Scomberomorus plurilineatus( KAK )", "Thunnus albacares( YFT )", "Thunnus obesus( BET )", "Tuna( NGR )")) %>%
        mutate(group = "Tuna fish"),
      
      species%>%
        filter(Species == "Octopus cyanea( OCC )") %>%
        mutate(group = "Octopus"),
      species %>% 
  filter(Species %in% c("Aetobatus ocellatus( MAE )", "Carcharhinus albimarginatus( ALS )", "Carcharhinus plumbeus( CCP )", "Carcharhinus sorrah( CCQ )", "Himantura uarnak( DHV )", "Maculabatis ambigua( RAJ )", "Manta alfredi( TNG )", "Rhynchobatus sp.( RCD )", "Taa( NYG )", "Taa( NYG )", "Papa mavongoroa( PMV )", "Papa( PP )"))%>%
        mutate(group = "Elasmobranch"),
      
      species%>%
        filter(Species %in% c("Mackerel(scomber)( KB )", "Mackerel(scomber)( VB )", "Sardine( DA )","Sardine( DA )" ,"Dagaa ( DPP )","Dagaa ( DPP )", "Amblygaster sirm( AMS )", "Decapterus russelli( RUS )", "Dussumieria acuta( DSA )")) %>%
        mutate(group = "Small pelagic")
) %>%
  rename(catch = 5)


```



```{r fig.cap="Trend of error free catch data per each site"}

catch.clean.group.outlierfree = list()

sites = dominant.group %>% distinct(Location) %>% pull()

for (i in 1:length(sites)){
  
  dummy = dominant.group %>% filter(Location == sites[i])
    q = quantile(dummy$catch, na.rm = TRUE)
    iqr = IQR(dummy$catch, na.rm = TRUE) # alternative: iqr = q[4]-q[2]
    
    lower = q[2] - (1.5 * iqr)
    upper = q[4] + (1.5 * iqr)
    
 catch.clean.group.outlierfree[[i]] = dummy %>% 
   filter(catch > lower & catch <= upper)
  
}

catch.clean.group.outlierfree = catch.clean.group.outlierfree %>% 
  bind_rows() 


```


```{r}
tz = st_read("e:/GIS/tanzania-latest.shp/nbs/Districts.shp", quiet = TRUE )

# tz %>% arrange(District_N) %>% pull(District_N)
```

```{r}

catch.clean.join = catch.clean.group.outlierfree %>% 
  # filter(group == "Reef fish") %>% 
  mutate(Location = replace(Location, Location == "Kigamboni", "Temeke"),
         Location = replace(Location, Location == "Kibiti", "Rufiji"), 
         Location = replace(Location, Location == "Lindi Rural", "Lindi"),
         Location = replace(Location, Location == "Mtwara Rural", "Mtwara")) %>%
  group_by(Location, group) %>% summarise(catch = mean(catch, na.rm = TRUE)) %>%
  ungroup() %>%
  rename(District = Location)


rumaki.districts = catch.clean.join %>% distinct(District) %>% pull()


coastal = tz %>% filter(District_N %in% rumaki.districts)

# coastal %>% mapview::mapview()



catch.clean.join.spatial = coastal %>% 
  rename(District = District_N)  %>% 
  full_join(catch.clean.join, by = c("District")) %>%
  mutate(catch = round(catch, digits = 2),class = cut(catch, breaks = seq(0,400,75), 
                     labels = c("Below 75", "75-150", "150-225", "225-300", "above 300")))

 
```


```{r}

coordinates = catch.clean.join.spatial %>% 
                  # filter(Zone == "OTHER" & group == "Tuna fish") %>%
  select(District, group) %>% 
  st_centroid() %>% 
  st_coordinates() %>% 
  as_tibble() %>% 
  rename(lon = 1, lat = 2) %>%
  bind_cols(
    catch.clean.join.spatial %>% 
      # filter(Zone == "OTHER" & group == "Tuna fish") %>%
      select(District, group) %>% st_drop_geometry()
  )


# catch.clean.join.spatial %>% df_spatial()
```

This report present the fishery statistics in RUMAKI seascape for the five family. The availability of these group varies among the RUMAKI seascape's districts (Table \@ref(tab:tab31)). For instance, while Kilwa \index{RUMAKI!Kilwa} and Kigamboni \index{RUMAKI!Kigamboni} are the district with catches of all five priority group, Mafia \index{RUMAKI!Mafia} and Mtwara \index{RUMAKI!Mtwara} had all four group except small pelagic and Kibiti \index{RUMAKI!Kibiti} is the only district in RUMAKI seascape with only *Elasmobranch* and *Reef fish*. This were the group with dominant catches and were mostly common in the areas. Therefore, we report the and discuss the statistics of these five priority fishery groups (Table \@ref(tab:tab31). First, we are providing a general picture of areas with high and low catches along the coast. Second, we zoom in into specific group performance in each coastal district. 


```{r tab31}

priority.group = coordinates %>%
  group_by(District) %>%
  summarise(count = n()) %>%
  ungroup() %>%
  mutate(Group = c("Elasmobranch,Octopus,Reef fish,Small pelagic,Tuna fish", 
                   "Octopus,Reef fish,Small pelagic,Tuna fish", 
                   "Elasmobranch,Octopus,Reef fish,Tuna fish", 
                   "Elasmobranch,Reef fish", 
                   "Elasmobranch,Octopus,Reef fish,Small pelagic,Tuna fish")) %>%
  select(-count)%>%
  mutate(District = replace(District, District == "Temeke", "Kigamboni"),
         District = replace(District, District == "Rufiji", "Kibiti")) 


priority.group %>%
  kableExtra::kable(format = "latex", 
                    col.names = c("RUMAKI District", "Fishery Group"),
                    booktabs = TRUE,
                    caption = "Five priority fishery groups found at each RUMAKI district") %>%
  kableExtra::column_spec(column = 1, bold = FALSE)%>%
  kableExtra::column_spec(column = 1, width = "2.5in")%>%
  kableExtra::column_spec(column = 2, italic = TRUE)%>% 
  kable_styling(font_size = ifelse(knitr:::is_latex_output(), 10, 16), 
                latex_options = c("hold_position"))

```

## Status of stock healthiness in RUMAKI and Non-RUMAKI districts. 
The status of fish stock healthiness in the RUMAKI and Non-RUMAKI  (area outside FISHCOM project) districts was assessed based on the data from CAS spanning from 2014 to 2018 and additional data from the e--CAS spanning from 2016 to 2019 respectively. To visualize the magnitude of fisheries landing from each district spatial maps were developed (Figure 1-5) for the five priority fishery groups (Table \@ref(tab:tab31). 



##  Spatial variation of fisheries total landings in the RUMAKI and non-RUMAKI districts for selected major fisheries groups.


```{r}
species = read_csv("../data_update/All data combined_cleaned.csv")

species = species %>% separate(Eng_name, c("Genus", "Species"), sep = " ", remove = FALSE)

# species %>% distinct(Genus) %>% arrange(Genus)
```

```{r}

dominant.group = bind_rows(
      species%>%
        filter(Genus == "Lethrinus") %>%
        mutate(group = "Reef fish"),
      
      species%>%
        filter(Genus %in% c("Euthynus", "Scomberomorus", "Thunnus", "Tuna", "Xiphias ")) %>%
        mutate(group = "Tuna fish"),
      
      species%>%
        filter(Genus == "Octopus") %>%
        mutate(group = "Octopus"),
      
      species%>%
        filter(Genus %in% c("Mackerel", "Sardinella")) %>%
        mutate(group = "Small pelagic")
) %>%
  mutate(catch = as.numeric(`Catch(t)`))


```

```{r}
catch.clean.group.outlierfree = list()
sites = dominant.group %>% distinct(Districts) %>% pull()

for (i in 1:length(sites)){
  
  dummy = dominant.group %>% filter(Districts == sites[i])
    q = quantile(dummy$catch, na.rm = TRUE)
    iqr = IQR(dummy$catch, na.rm = TRUE) # alternative: iqr = q[4]-q[2]
    
    lower = q[2] - (1.5 * iqr)
    upper = q[4] + (1.5 * iqr)
    
 catch.clean.group.outlierfree[[i]] = dummy %>% 
   filter(catch > lower & catch <= upper)
  
}

catch.clean.group.outlierfree = catch.clean.group.outlierfree %>% 
  bind_rows() %>%
  mutate(Districts = replace(Districts, Districts=="Kindondoni", "Kinondoni"),
         Districts = replace(Districts, Districts=="Lindi urban","Lindi Urban"),
         Districts = replace(Districts, Districts=="Lindi", "Lindi Urban"))
```


```{r}
tz = st_read("e:/GIS/tanzania-latest.shp/nbs/Districts.shp", quiet = TRUE )


```

```{r}
rumaki.districts = catch.clean.group.outlierfree %>% 
  distinct(Districts) %>% 
  pull()

rumaki.districts[3] = "Tanga Urban"
rumaki.districts[16] = "Lindi"

coastal = tz %>% filter(District_N %in% rumaki.districts)

# coastal %>% mapview::mapview()

catch.clean.join = catch.clean.group.outlierfree %>% 
  # filter(group == "Reef fish") %>% 
  mutate(Year = as.integer(Year),
         # Districts = replace(Districts, Districts == "Temeke", "Kigamboni"),
         Districts = replace(Districts, Districts == "Rufiji", "Kibiti"), 
         Districts = replace(Districts, Districts == "Lindi Rural", "Lindi"),
         Districts = replace(Districts, Districts == "Mtwara Rural", "Mtwara")) %>%
  group_by(Districts, Zone, group, Year) %>% 
  summarise(catch = mean(catch, na.rm = TRUE)) %>%
  ungroup()


catch.clean.join.spatial = coastal %>% 
  rename(Districts = District_N)  %>% 
  right_join(catch.clean.join) %>%
  mutate(class = cut(catch, breaks = seq(0,400,75), 
                     labels = c("Below 75", "75-150", "150-225", "225-300", "above 300")))


```

```{r}
coordinates = catch.clean.join.spatial %>% 
                  # filter(Zone == "OTHER" & group == "Tuna fish") %>%
  select(Districts, group) %>% 
  st_centroid() %>% 
  st_coordinates() %>% 
  as_tibble() %>% 
  rename(lon = 1, lat = 2) %>%
  bind_cols(
    catch.clean.join.spatial %>% 
      # filter(Zone == "OTHER" & group == "Tuna fish") %>%
      select(Districts, group) %>% st_drop_geometry()
  )
```

```{r tab32}
catch.summarized = catch.clean.join.spatial %>% 
  st_drop_geometry()%>% 
  mutate(Districts = replace(Districts, Districts == "Temeke", "Kigamboni"),
         Districts = replace(Districts, Districts == "Rufiji", "Kibiti"), 
         Districts = replace(Districts, Districts == "Lindi Rural", "Lindi"),
         Districts = replace(Districts, Districts == "Mtwara Rural", "Mtwara")) %>% 
  group_by(Zone, group) %>% 
  summarise(count = n(), 
            annual.catch = mean(catch, na.rm = TRUE)/length(n), 
            standardized.catch = annual.catch/count) %>%
  ungroup() %>%
  drop_na() %>%
  mutate_if(is.character, as.factor) %>%
  mutate_if(is.numeric, round, digits = 2)

catch.summarized %>% 
  arrange(Zone, group) %>% select(-count) %>% 
  kableExtra::kable(format = "latex", booktabs = TRUE, align = "c", caption = "Annual mean catch and annual catch rate of four priority fishery for RUMAKI and Non--RUMAKI fishing areas",
                    col.names = c("Fishing\n Zone", "Priority\nFish", "Mean Catch\n (Tones)",
                                  "Catch Rate\n (Tones/year/district)")) %>%
  kableExtra::collapse_rows(columns = 1, latex_hline = "major", valign = "middle") %>%
  kableExtra::column_spec(column = 1:3, width = "1.2in")%>%
   # kableExtra::kable_styling(full_width = FALSE) %>%
  kableExtra::add_header_above(c("", "", "Annual Fish catches" = 2))%>% 
  kable_styling(font_size = ifelse(knitr:::is_latex_output(), 10, 16), 
                latex_options = c("hold_position"))


```

### *Octopus cyanea*

```{r}


catch.pooled.sf = catch.clean.join.spatial %>%
  filter(!is.na(District_C))%>%
  st_transform(4326) %>%
  group_by(Districts, Zone, group) %>%
  summarise(catch = mean(catch)) %>%
  ungroup() %>%
  mutate(class = cut(catch, breaks = seq(0,400,75),
                     labels = c("Below 75", "75-150", "150-225", "225-300", "above 300")))


# catch.summarized %>% filter(group == "Octopus" & Zone == "RUMAKI") %>% pull(standardized.catch)
# catch.summarized %>% filter(group == "Octopus" & Zone != "RUMAKI") %>% pull(standardized.catch)
```


@guard reported that in Tanzania there were only one species of octopus in Tanzania. The average catch rate for the octopus fishery in RUMAKI was `r catch.summarized %>% filter(group == "Octopus" & Zone == "RUMAKI") %>% pull(standardized.catch)` tones per year and for Non--RUMAKI was `r catch.summarized %>% filter(group == "Octopus" & Zone != "RUMAKI") %>% pull(standardized.catch)` tones per year (Table \@ref(tab:tab32)). The spatial maps indicate the district of Ilala  had the highest catches in the non-RUMAKI, whereas districts of Kilwa and Lindi revealed the highest catch landings   for  RUMAKI areas (Figure \@ref(fig:fig31)). The possible explanation for Ilala to have the highest catch could be the country's main marine fisheries market (The Ferry Market) is located in Ilala, Dar es Salaam. It receives landings from other parts of the country, particularly from the southern coast regions. Therefore, apart from  Ilala being a landing site it also serves as the main market for fishers and fish traders from other parts of the country. On the other hand, the lowest catches noted at Temeke and Mtwara could be related to the limited seascape for these districts and close proximity to the main ferry market for the case of Temeke. Rufiji is exceptional, the large part of its fishing ground is dominated by mudflats and continuous influx of riverine waters from the delta. This habitat is known to be favourable for prawn fishing. Kilwa is well known for octopus fisheries particularly Songosongo archipelago (Gaurd, ..). Surprisingly Mafia districts have not surfaced as an area with higher Octopus landings, but other studies (Muhaji xx, Guard xx and Kishe et xx, WWF xx ) reported  higher landings of octopus from Mafia. The possible explanation was weakness in CAS data collection in Mafia. 



```{r fig31, fig.cap = "Average annual catch for Octopus in (a) RUMAKI and (b) Non-RUMAKI coastal districts", fig.width=7, fig.height=3.5}

# "Octopus"       "Reef fish"     "Tuna fishery"     "Small pelagic"

rumaki = ggplot() +
  layer_spatial(data = tz, fill = "grey90", col = "ivory", size = 0.2)+
  layer_spatial(data = catch.pooled.sf %>% 
                  filter(Zone == "RUMAKI" & group == "Octopus"),
          aes(fill = class), col = "ivory", size = 0.2) +
  ggrepel::geom_text_repel(data = coordinates %>% filter(lat <= -7.6 & group == "Octopus") %>% distinct(Districts, lon,lat),
                            aes(x = lon, y = lat, label = Districts),
                           point.padding = 2.2, size = 3.2, col = "grey70") +
 coord_sf(xlim = c(37.5,40.5), ylim = c(-11.1,-7.5), crs = 4326)+
  ggsci::scale_fill_locuszoom(name = "Catch \n(Tonnes)") +
  scale_y_continuous(breaks = c(-10.5,-8.25)) +
  scale_x_continuous(breaks = c(38.2,39.85))+
  theme_bw() +
  theme(panel.grid = element_line(linetype = 3), 
        axis.text = element_text(size = 10), 
        legend.text = element_text(size = 10), 
        legend.title = element_text(size = 10), 
        legend.position = "none",
        panel.background = element_rect(fill = NA, colour = "black"))+
  # ggspatial::annotation_scale(position = "bl", bar_cols = c("grey", "ivory"), text_cex = .75)+
  labs(x = "", y = "")+
  annotate(geom = "text", x = 37.6, y = -7.6, label = "A)")

non.rumaki = ggplot() +
  layer_spatial(data = tz, fill = "grey90", col = "ivory", size = 0.2)+
  layer_spatial(data = catch.pooled.sf %>% 
                  filter(Zone != "RUMAKI" & group == "Octopus") ,
          aes(fill = class), col = "ivory", size = 0.2) +
  ggrepel::geom_text_repel(data = coordinates %>% filter(lat >= -7.6 & group == "Octopus") %>% distinct(Districts, lon,lat),
                            aes(x = lon, y = lat, label = Districts),
                           point.padding = 2.2, size = 3.4, size = 3.2, col = "grey70") +
  coord_sf(xlim = c(37.8,40.3), ylim = c(-7.6,-4.5), crs = 4326)+
  ggsci::scale_fill_locuszoom(name = "Catch \n(Tonnes)") +
  scale_x_continuous(breaks = c(38.1,39.7))+
  scale_y_continuous(breaks = c(-7.25,-4.75)) +
  theme_bw() +
  theme(panel.grid = element_line(linetype = 3), 
        axis.text = element_text(size = 10), 
        legend.text = element_text(size = 10), 
        legend.title = element_text(size = 10),
        panel.background = element_rect(fill = NA, colour = "black"))+
  # ggspatial::annotation_scale(position = "bl", bar_cols = c("grey", "ivory"), text_cex = .75)+
  labs(x = "", y = "") +
  annotate(geom = "text", x = 40.1, y = -4.6, label = "B)")

rumaki + non.rumaki

# ggsave("front.pdf")
```



### *Tuna and tuna-like species *
The average catch rate for the octopus fishery in RUMAKI was `r catch.summarized %>% filter(group == "Tuna fish" & Zone == "RUMAKI") %>% pull(standardized.catch)` tones per year and for Non--RUMAKI was `r catch.summarized %>% filter(group == "Tuna fish" & Zone != "RUMAKI") %>% pull(standardized.catch)` tones per year (Table \@ref(tab:tab32)). The spatial maps indicate the districts of Ilala have highest catches while Muheza, Pangani and Mkuranga and xx have lowest catches in the non-RUMAKI and RUMAKI areas respectively (Figure \@ref(fig:fig32)). Description of the output from statistical analysis of the CAS data of tuna and tuna like species reveals Ilala district to be healthier ecologically than other coastal districts. However, this may be misleading information. The route cause could be the existing weak statistical data collection system. Ilala is a market center for tuna and tuna like fish species . Good prices are found in Dar es salaam because of high demand from restaurants and hotels. The purchasing power of the residents of Dar es salaam  is relatively higher compared to other districts along the coast of Tanzania. Therefore, most fishermen from other coastal districts  depend on the ferry market for the high value of their catch. Information on tuna and tuna like  fisheries in Tanzania  is limited Mshana et al (XX) and the recent preliminary SwioFish priority tuna and tuna like fisheries study findings suggest Tanga city and Mtwara municipal are leading in landing of tuna and tuna like species. It is advised that more effort is needed to improve the data collection system particularly at the marketing center, making sure the catch information of the original district where the catch is from is captured (improvement in traceability). The priority representatives species for each fishery are well captured based on fisheries experts.  However, data related to artisanal tuna and tuna-like species is hardly known, the current data eCAS collection systems in Tanzania is an initiative addressing this challenge. The initiative has managed to separate tuna from other fish species but the effort is needed to collect error-free data at species level as required by the Indian Ocean Tuna Commission (IOTC).



```{r fig32, fig.cap="Average annual catch for Tuna fishery in (a) RUMAKI and (b) Non-RUMAKI coastal districts", fig.width=7, fig.height=3.5}


rumaki = ggplot() +
  layer_spatial(data = tz, fill = "grey90", col = "ivory", size = 0.2)+
  layer_spatial(data = catch.pooled.sf %>% 
                  filter(Zone == "RUMAKI" & group == "Tuna fish"),
          aes(fill = class), col = "ivory", size = 0.2) +
  ggrepel::geom_text_repel(data = coordinates %>% filter(lat <= -7.6 & group == "Tuna fish") %>% distinct(Districts, lon,lat),
                            aes(x = lon, y = lat, label = Districts),
                           point.padding = 2.2, size = 3.2, col = "grey70") +
 coord_sf(xlim = c(37.5,40.5), ylim = c(-11.1,-7.5), crs = 4326)+
  ggsci::scale_fill_locuszoom(name = "Catch \n(Tonnes)") +
  scale_y_continuous(breaks = c(-10.5,-8.25)) +
  scale_x_continuous(breaks = c(38.2,39.85))+
  theme_bw() +
  theme(panel.grid = element_line(linetype = 3), 
        axis.text = element_text(size = 10), 
        legend.text = element_text(size = 10), 
        legend.title = element_text(size = 10), 
        legend.position = "none",
        panel.background = element_rect(fill = NA, colour = "black"))+
  # ggspatial::annotation_scale(position = "bl", bar_cols = c("grey", "ivory"), text_cex = .75)+
  labs(x = "", y = "")+
  annotate(geom = "text", x = 37.6, y = -7.6, label = "A)")

non.rumaki = ggplot() +
  layer_spatial(data = tz, fill = "grey90", col = "ivory", size = 0.2)+
  layer_spatial(data = catch.pooled.sf %>% 
                  filter(Zone != "RUMAKI" & group == "Tuna fish") ,
          aes(fill = class), col = "ivory", size = 0.2) +
  ggrepel::geom_text_repel(data = coordinates %>% filter(lat >= -7.6 & group == "Tuna fish") %>% distinct(Districts, lon,lat),
                            aes(x = lon, y = lat, label = Districts),point.padding = 2.2,
                           size = 3.2, col = "grey70") +
  coord_sf(xlim = c(37.8,40.3), ylim = c(-7.6,-4.5), crs = 4326)+
  ggsci::scale_fill_locuszoom(name = "Catch \n(Tonnes)") +
  scale_x_continuous(breaks = c(38.1,39.7))+
  scale_y_continuous(breaks = c(-7.25,-4.75)) +
  theme_bw() +
  theme(panel.grid = element_line(linetype = 3), 
        axis.text = element_text(size = 10), 
        legend.text = element_text(size = 10), 
        legend.title = element_text(size = 10),
        panel.background = element_rect(fill = NA, colour = "black"))+
  # ggspatial::annotation_scale(position = "bl", bar_cols = c("grey", "ivory"), text_cex = .75)+
  labs(x = "", y = "") +
  annotate(geom = "text", x = 40.1, y = -4.6, label = "B)")

rumaki + non.rumaki
```

### *Small pelagic*

The average catch rate for the octopus fishery in RUMAKI was `r catch.summarized %>% filter(group == "Small pelagic" & Zone == "RUMAKI") %>% pull(standardized.catch)` tones per year and for Non--RUMAKI was `r catch.summarized %>% filter(group == "Small pelagic" & Zone != "RUMAKI") %>% pull(standardized.catch)` tones per year (Table \@ref(tab:tab32)). The spatial maps indicate the districts of Kindondoni and Mkuranga have highest catch, this is true for Kilwa and Mtwara in the RUMAKI area. Pangani and Temeke and Rufiji have lowest catch in the non-RUMAKI and RUMAKI areas respectively (Figure  \@ref(fig:fig33)). A quick interpretation of these results is that most landings of small pelagic fish are in Dar es salaam but in the actual sense Dar es salaam is a marketing center and most fishermen from the northern coastal district as well as southern coastal districts bring fish to the market.  Pangani and particularly Kipumbwi is known to be among the best landing sites for small pelagic fisheries in Tanzania coastal districts, however the analysis of CAS data reveals the opposite. The general conclusion there was a weakness in the data collection system.  Data related to small pelagic is scarce and in most cases underestimated. This is due to the nature of the fishery itself, landing is usually packed in boxes or buckets and sold in bulk, makes the estimation difficult. A dedicated effort is needed to make sure data related to small pelagic is accurately collected, more important during the peak season in NEM (calm sea with favourable temperature and nutrients (Abdellaoui et al 2017). 


```{r fig33, fig.cap="Average annual catch for small pelagic in (a) RUMAKI and (b) Non-RUMAKI coastal districts", fig.width=7, fig.height=3.5}


rumaki = ggplot() +
  layer_spatial(data = tz, fill = "grey90", col = "ivory", size = 0.2)+
  layer_spatial(data = catch.pooled.sf %>% 
                  filter(Zone == "RUMAKI" & group == "Small pelagic"),
          aes(fill = class), col = "ivory", size = 0.2) +
  ggrepel::geom_text_repel(data = coordinates %>% filter(lat <= -7.6 & group == "Small pelagic") %>% distinct(Districts, lon,lat),
                            aes(x = lon, y = lat, label = Districts),
                           point.padding = 2.2, size = 3.2, col = "grey70") +
 coord_sf(xlim = c(37.5,40.5), ylim = c(-11.1,-7.5), crs = 4326)+
  ggsci::scale_fill_locuszoom(name = "Catch \n(Tonnes)") +
  scale_y_continuous(breaks = c(-10.5,-8.25)) +
  scale_x_continuous(breaks = c(38.2,39.85))+
  theme_bw() +
  theme(panel.grid = element_line(linetype = 3), 
        axis.text = element_text(size = 10), 
        legend.text = element_text(size = 10), 
        legend.title = element_text(size = 10), 
        legend.position = "none",
        panel.background = element_rect(fill = NA, colour = "black"))+
  # ggspatial::annotation_scale(position = "bl", bar_cols = c("grey", "ivory"), text_cex = .75)+
  labs(x = "", y = "")+
  annotate(geom = "text", x = 37.6, y = -7.6, label = "A)")

non.rumaki = ggplot() +
  layer_spatial(data = tz, fill = "grey90", col = "ivory", size = 0.2)+
  layer_spatial(data = catch.pooled.sf %>% 
                  filter(Zone != "RUMAKI" & group == "Small pelagic") ,
          aes(fill = class), col = "ivory", size = 0.2) +
  ggrepel::geom_text_repel(data = coordinates %>% filter(lat >= -7.6 & group == "Small pelagic") %>% distinct(Districts, lon,lat),
                            aes(x = lon, y = lat, label = Districts),point.padding = 2.2, 
                           size = 3.2, col = "grey70") +
  coord_sf(xlim = c(37.8,40.3), ylim = c(-7.6,-4.5), crs = 4326)+
  ggsci::scale_fill_locuszoom(name = "Catch \n(Tonnes)") +
  scale_x_continuous(breaks = c(38.1,39.7))+
  scale_y_continuous(breaks = c(-7.25,-4.75)) +
  theme_bw() +
  theme(panel.grid = element_line(linetype = 3), 
        axis.text = element_text(size = 10), 
        legend.text = element_text(size = 10), 
        legend.title = element_text(size = 10),
        panel.background = element_rect(fill = NA, colour = "black"))+
  # ggspatial::annotation_scale(position = "bl", bar_cols = c("grey", "ivory"), text_cex = .75)+
  labs(x = "", y = "") +
  annotate(geom = "text", x = 40.1, y = -4.6, label = "B)")

rumaki + non.rumaki
```


### *Reef species*
Reef fisheries contributes to over 90% of total fish landings. The average catch rate for the octopus fishery in RUMAKI was `r catch.summarized %>% filter(group == "Reef fish" & Zone == "RUMAKI") %>% pull(standardized.catch)` tones per year and for Non--RUMAKI was `r catch.summarized %>% filter(group == "Reef fish" & Zone != "RUMAKI") %>% pull(standardized.catch)` tones per year (Table \@ref(tab:tab32)). The spatial map indicates catch (MT) variation for reef fishery among the non-RUMAKI area (Figure \@ref(fig:fig34)), the districts of Pangani ranked highest (catches above 225 tonnes/year), followed by Mkinga and Kinondoni. Muheza and Bagamoyo ranked least with catches below 75 tonnes/yr. 


```{r fig34, fig.cap="Average annual catch for reef fish in (a) RUMAKI and (b) Non-RUMAKI coastal districts", fig.width=7, fig.height=3.5}

rumaki = ggplot() +
  layer_spatial(data = tz, fill = "grey90", col = "ivory", size = 0.2)+
  layer_spatial(data = catch.pooled.sf %>% 
                  filter(Zone == "RUMAKI" & group == "Reef fish"),
          aes(fill = class), col = "ivory", size = 0.2) +
  ggrepel::geom_text_repel(data = coordinates %>% filter(lat <= -7.6 & group == "Reef fish") %>% distinct(Districts, lon,lat),
                            aes(x = lon, y = lat, label = Districts),
                           point.padding = 2.2, size = 3.2, col = "grey70") +
 coord_sf(xlim = c(37.5,40.5), ylim = c(-11.1,-7.5), crs = 4326)+
  ggsci::scale_fill_locuszoom(name = "Catch \n(Tonnes)") +
  scale_y_continuous(breaks = c(-10.5,-8.25)) +
  scale_x_continuous(breaks = c(38.2,39.85))+
  theme_bw() +
  theme(panel.grid = element_line(linetype = 3), 
        axis.text = element_text(size = 10), 
        legend.text = element_text(size = 10), 
        legend.title = element_text(size = 10), 
        legend.position = "none",
        panel.background = element_rect(fill = NA, colour = "black"))+
  # ggspatial::annotation_scale(position = "bl", bar_cols = c("grey", "ivory"), text_cex = .75)+
  labs(x = "", y = "")+
  annotate(geom = "text", x = 37.6, y = -7.6, label = "A)")

non.rumaki = ggplot() +
  layer_spatial(data = tz, fill = "grey90", col = "ivory", size = 0.2)+
  layer_spatial(data = catch.pooled.sf %>% 
                  filter(Zone != "RUMAKI" & group == "Reef fish") ,
          aes(fill = class), col = "ivory", size = 0.2) +
  ggrepel::geom_text_repel(data = coordinates %>% filter(lat >= -7.6 & group == "Reef fish") %>% distinct(Districts, lon,lat),
                            aes(x = lon, y = lat, label = Districts),
                           point.padding = 2.2, size = 3.2, col = "grey70") +
  coord_sf(xlim = c(37.8,40.3), ylim = c(-7.6,-4.5), crs = 4326)+
  ggsci::scale_fill_locuszoom(name = "Catch \n(Tonnes)") +
  scale_x_continuous(breaks = c(38.1,39.7))+
  scale_y_continuous(breaks = c(-7.25,-4.75)) +
  theme_bw() +
  theme(panel.grid = element_line(linetype = 3), 
        axis.text = element_text(size = 10), 
        legend.text = element_text(size = 10), 
        legend.title = element_text(size = 10),
        panel.background = element_rect(fill = NA, colour = "black"))+
  # ggspatial::annotation_scale(position = "bl", bar_cols = c("grey", "ivory"), text_cex = .75)+
  labs(x = "", y = "") +
  annotate(geom = "text", x = 40.1, y = -4.6, label = "B)")

rumaki + non.rumaki
```

## Catch trend comparison of stock healthiness between FISHCOM area and the rest of the district
The annual average fish catch and catch rate in the RUMAKI  and Non-RUMAKI between 2014 and 2018 are shown in appendix \@ref(tab:tab07). The catch rate in RUMAKI was relatively higher compared to other areas for all species except small pelagic (Figure \@ref(fig:fig35)). This trend in catch rate was computed based on number of district per zone and the intepretation of this result should be treated with caution as the number of fishers, vessels, fishing areas and other parameters are not the same. Despite that drawback in this result, the standardized catch rate in RUMAKI \index{RUMAKI} is doing better compared to other districts. The good performance of fisheries in RUMAKI area is contributed with the effective fisheries co-management initiative supported with WWF-Tanzania\index{Institutions!WWF}.


```{r fig35, fig.cap="Mean Catches and standard error for the four common fish group in Rumaki and Non-Rumaki area", fig.width=8, fig.height=6}
catch.stats = catch.clean.group.outlierfree %>% 
  group_by(Year,Zone, group) %>% 
  summarise(n = n(),
            catch.mean = mean(catch, na.rm = TRUE),
            catch.median = median(catch, na.rm = TRUE),
            catch.sd = sd(catch, na.rm = TRUE),
            catch.se = catch.sd/sqrt(n),
            catch.rate = catch.median/n,
            catch.rate.se = catch.se/n) %>%
  ungroup() 


catch.stats %>% 
  ggplot(aes(x = Year, y = catch.rate, col = Zone)) +
  geom_line() +
  geom_errorbar(aes(ymin = catch.rate - catch.rate.se, 
                    ymax = catch.rate + catch.rate.se), width = 0.075)+  
  geom_point(size = 3)+
  facet_wrap(~group, strip.position = "top" , scales = "free_y")+
  theme(panel.grid = element_line(linetype = "dotted"), 
        panel.background = element_rect(fill = "white", colour = "black"),
        legend.position = "right", 
        legend.text = element_text(size = 9), 
        axis.text = element_text(size = 10), 
        axis.title = element_text(size = 11),
        strip.background = element_blank(),
        legend.key = element_blank(),
        legend.key.width = unit(.85,"cm"))+
  labs(x = "", y = "Catch rates (Tonnes)")+
   ggsci::scale_color_d3(name = "")+
  scale_x_continuous(breaks = 2014:2017)

```




## Status of stock healthiness in the RUMAKI districts
The status of fish stock healthiness in the RUMAKI districts was assessed based on the data obtained from the eCAS for the year 2016 to 2019 . The use of mobile application in fisheries data collection was firstly implemented as a pilot project in the three districts of Mafia, Kilwa and Rufiji/Kibiti. Therefore, during this period data from Kigamboni and Mtwara rural is missing in the system. Part of the next analysis (Figure 6-8) excluded data collected in the year 2014-2015 as districts of Kigamboni and Kibiti were not part of the pilot project. 

## Catch Trends for priority fisheries stock in the RUMAKI 
The current findings indicate there is a decrease in total catch from artisanal fishers in the RUMAKI districts for all major fisheries groups with the exception of small pelagic (Figure \@ref(fig:fig320)). This is based on the data collected by BMUs members at different landing sites from 2016-2019. The direct reasons linked to this trend could not be established, as environment data, catch and effort and other parameters are not part of the general fisheries data collection. Potential reasons could be due to the environmental variability and specifically increased in sea surface temperature (SST).  TAFIRI is independently monitoring change in environmental conditions for the entire coast, findings suggest from 2016 to 2019 there has been a change in sea surface water temperature annual anomaly of 1.7oC and particularly in 2017 (Fig. 5a and b). The other reason could be anthropogenic,  specifically dynamite fishing, but this is yet to be linked/confirmed. However, Pandu (2014) suggested, increasing demand from the hotel sector is leading to overfishing as well as  the escalating use of destructive fishing methods.


```{r fig320, fig.cap="Catches pooled for the five common fish group in Rumaki area", fig.width=8, fig.height=4}
catch.zone = catch.clean.group.outlierfree %>% group_by(Year, group) %>% 
  summarise(n = n(),
            catch.mean = mean(catch, na.rm = TRUE),
            catch.median = median(catch, na.rm = TRUE),
            catch.sd = sd(catch, na.rm = TRUE),
            catch.se = catch.sd/sqrt(n)) %>%
  ungroup() 

catch.zone %>% 
  ggplot(aes(x = Year, y = catch.median,col = group)) +
  geom_line() +
  geom_errorbar(aes(ymin = catch.median - catch.se, 
                    ymax = catch.median + catch.se), width = 0.075)+
  geom_point(size = 3)+
  theme(panel.grid = element_line(linetype = "dotted"), 
        panel.background = element_rect(fill = "white", colour = "black"),
        legend.position = "right", 
        legend.text = element_text(size = 9), 
        axis.text = element_text(size = 10), 
        axis.title = element_text(size = 11),
        strip.background = element_blank(),
        legend.key = element_blank(),
        legend.key.width = unit(.85,"cm"))+
  labs(x = "", y = "Total Catch (Tonnes)")+
   ggsci::scale_color_d3(name = "Fish\nGroup")+
  facet_wrap(~group, scales = "free_y")+
  scale_y_continuous(trans = scales::log10_trans())



```

## Comparison of the total catch for priority fisheries groups among RUMAKI districts 
Catch trends of the major fishery groups in the RUMAKI area are shown in Figure 6.  Despite the general trend of decreased fish catch in the RUMAKI districts, a detailed analysis for each district indicates some fisheries categories seem to be doing better in some places between 2016 to 2019. For instance, octopus and tuna species catches show an increase in Kigamboni, likewise, reef fish and octopus in Mtwara rural. More importantly, there is some consistency in the data collection for Kibiti, Kigamboni, Kilwa and Mafia districts (Fig 6a&b). This is good news. Though this is not yet to the standard that will assist a full stocks assessment it is a good starting point. The data points gaps in Mtwara and Kibiti indicate the inconsistency in the data collection. Both Kigamboni and Mtwara picked up a year later after the piloting phase, but Kigamboni has kept the consistency. 


```{r fig36, fig.cap="District in Rumaki areas with relatively decline annual catches", fig.width=6.5, fig.height=4.5}

load("data/fish_catch_statistics.RData")

formula1 = "y~poly(x,1)"

ggplot(data = catch.clean.group.outlierfree %>% 
         filter(Zone == "RUMAKI" & !Districts %in% c("Rufiji", "Mtwara", "Mtwara Urban")) , 
       aes(x = Year, y = catch, col = Districts, fill = Districts))+
  geom_point()+
  geom_smooth(se = TRUE, alpha = .1, method = "lm", formula = formula1)+
  # ggpmisc::stat_fit_tb(method = "lm",
  #             method.args = list(formula = formula1),
  #             tb.vars = c(Parameter = "term", 
  #                         Estimate = "estimate", 
  #                         "s.e." = "std.error", 
  #                         "italic(t)" = "statistic", 
  #                         "italic(P)" = "p.value"),
  #             label.y = "top", label.x = "right",
  #             parse = TRUE)+
  ggpmisc::stat_poly_eq(aes(label = paste0("atop(", ",", ..rr.label.., ")")), 
               formula = formula1, rr.digits = 2,
               parse = TRUE) +
  # ggrepel::geom_text_repel(data = now, aes(x = date, y = catch, label = label)) +
  scale_x_continuous(breaks = 2015:2017) +
  # scale_y_continuous(trans = scales::log10_trans())+
  # cowplot::theme_minimal_grid()+
  # theme(panel.grid = element_line(linetype = "dotted"), legend.position = "none")+
  theme(panel.grid = element_line(linetype = "dotted"), 
        panel.background = element_rect(fill = "NA", colour = "black"),
        legend.position = "none", 
        legend.text = element_text(size = 9), 
        axis.text = element_text(size = 10), 
        axis.title = element_text(size = 11),
        strip.background = element_blank(),
        legend.key.width = unit(.5,"cm"))+
  facet_wrap(~Districts, scales = "free")+
  labs(x = "", y = "Fish catch (Tonnes)")+
  scale_fill_brewer(palette = "Dark2", name = "Dominant \nSpecies")+
  scale_colour_brewer(palette = "Dark2", name = "Dominant \nSpecies")+
  scale_y_continuous(trans = scales::log10_trans())+
  coord_cartesian()
```

## Catch composition of major priority fisheries groups in RUMAKI districts
The current findings suggest reef fishes are the dominant landing in almost all districts, with the exception of Kilwa and Mtwara districts (Figure \@ref(fig:fig37) and \@ref(fig:fig38).  Octopus is also common in the four districts except for Rufiji. Interestingly there is more elasmobranch caught in Mtwara rural than any other area (Figure \@ref(fig:fig38)a), likewise, more small pelagic group in Kilwa than any other area (Figure \@ref(fig:fig38)b) . Rufiji in this context seems to be catching reef fishes and elasmobranch only, however, this is not true, the main fishery in this area is the prawn, catch related to prawn is documented from the industrial fishery. In general, in terms of catch composition, Kilwa and KIgamboni have all five fisheries (Figure \@ref(fig:fig37)); Mafia and Mtwara four fisheries Figure \@ref(fig:fig38); and Kibiti two fisheries (Table \@ref(tab:tab31). 


```{r fig37, fig.cap="Catch composition of major priority fisheries groups in a) Kigamboni and b) Kilwa Districts", fig.width=8, fig.height=4}

load("data/rumaki_fish_catch_statistics.RData")
require(RColorBrewer)

species.groups = dominant.group %>% 
  group_by(group, Location) %>% 
  summarise(weight = mean(catch, na.rm = TRUE)) %>% 
  ungroup() 



  temeke = species.groups %>%
  filter(Location == "Kigamboni")%>%
  mutate(percentage = (weight/sum(weight)*100) %>% round(digits = 1),
         labs = paste(percentage, "%"))%>%
  ggpubr::ggdonutchart(x = "percentage", 
                       label = "percentage",
                       fill = "group", color = "white", lab.pos = "in")+
  theme(legend.position = "none",
        legend.text = element_text(size = 10), 
        legend.title = element_text(size = 11))+
  ggsci::scale_fill_jama(name = "Dominant\nFish Groups") +  
  labs(subtitle = "a)")
  
  kilwa = species.groups %>%
  filter(Location == "Kilwa")%>%
  mutate(percentage = (weight/sum(weight)*100) %>% round(digits = 1),
         labs = paste(percentage))%>%
  ggpubr::ggdonutchart(x = "percentage", 
                       label = "percentage",
                       fill = "group", color = "white", lab.pos = "in")+
  theme(legend.position = "right",
        legend.text = element_text(size = 10), 
        legend.title = element_text(size = 11))+
  ggsci::scale_fill_jama(name = "Dominant\nFish Groups") +  
  labs(subtitle = "b)")
  
 
temeke + kilwa 
```


```{r fig38, fig.cap="Catch composition of major priority fisheries groups in a) Mtwara Rural and b) Mafia Districts", fig.height=4,fig.width=8}

 mtwara.rural = species.groups %>%
  filter(Location == "Mtwara Rural")%>%
  mutate(percentage = (weight/sum(weight)*100) %>% round(digits = 1),
         labs = paste(percentage, "%"))%>%
  ggpubr::ggdonutchart(x = "percentage", 
                       label = "percentage",
                       fill = "group", color = "white", lab.pos = "in")+
  theme(legend.position = "none",
        legend.text = element_text(size = 10), 
        legend.title = element_text(size = 11))+
  # scale_fill_viridis_d()+
  ggsci::scale_fill_jama(name = "Dominant\nFish Groups") +  
  labs(subtitle = "a)")
  
  
   mafia = species.groups %>%
  filter(Location == "Mafia")%>%
  mutate(percentage = (weight/sum(weight)*100) %>% round(digits = 1),
         labs = paste(percentage, "%"))%>%
  ggpubr::ggdonutchart(x = "percentage", 
                       label = "percentage",
                       fill = "group", color = "white", lab.pos = "in")+
  theme(legend.position = "right", 
        legend.text = element_text(size = 10), 
        legend.title = element_text(size = 11))+
  # scale_fill_viridis_d()+
  ggsci::scale_fill_jama(name = "Dominant\nFish Groups") +  
  labs(subtitle = "b)")
   
mtwara.rural + mafia
```


##  Seasonal variation of the total catch for priority fisheries in RUMAKI 
The use of eCAS helped analysis of the seasonal/ monthly fisheries catch variation of the major fisheries among Rumaki (Figure 7). Analysis of the monthly catch variation did not produce good results necessitating pooling data into the seasonal, North East (NE) and South East (SE)Monsoon. Yet no clear differences in catch variation could be observed in all fisheries categories.  The possible explanation is that the dataset was not enough to show such variation. More data needs to be collected for such an analysis to run. In the previous database in the CAS  such seasonal comparison in catch variation among sites could not be performed. 

```{r fig39, fig.width=8, fig.height=4, fig.cap="Seasonal (NE and South East SE Monsoon) variation in catch (Mt) composition of dominant priority fisheries groups among RUMAKI sites from 2016-2019"}



catch.clean.group.season = catch.clean.group.outlierfree %>%
mutate(season = Month,
       season = replace(season, season %in% c(10,11,12,1,2,3), "NE"),
       season = replace(season, season %in% c(4,5,6,7,8,9), "SE"))

catch.clean.group.season %>%
  ggplot(aes(x = season, y = catch , fill = group))+
  geom_boxplot(outlier.colour = "red") +
  facet_wrap(~Districts, scales = "free_y")+
  # cowplot::theme_minimal_grid()+
  theme(panel.grid = element_line(linetype = "dotted"), 
        panel.background = element_rect(fill = "white", colour = "black"),
        legend.position = "right", 
        legend.text = element_text(size = 9), 
        axis.text = element_text(size = 10), 
        axis.title = element_text(size = 11),
        strip.background = element_blank(),
        legend.key.width = unit(.5,"cm"))+
  scale_y_continuous(trans = scales::log10_trans())+
  labs(x = "", y = "Fish catches (Tonnes)")+
  # ggsci::scale_fill_jama(name = "Dominant \nSpecies")+
  scale_fill_brewer(palette = "Accent", name = "Dominant \nSpecies")
```



## Assessment of re-appearances of fish species  in the study area and its linkage to conservation
Previous information recorded on the CAS forms was able to record fish species to the family level. The new version of eCAS has room to record fish species catches to a species level. This is a major improvement, it does not only facilitate mandatory reporting to national and regional fisheries organizations but further allows the analysis of appearance/disappearance of endangered and other species of ecological importance. During the current analysis, we have noted re-appearance of the elasmobranch group in the database with a relatively good resolution. Interestingly Some species of shark and rays are captured in the database to the genus level,  though more effort for identification of the elasmobranch to species level is needed.  

\index{spatial}
\index{landings}
\index{magnitude}
\index{Tools!CAS}
\index{Institutions!RUMAKI}
\index{Institutions!Non--RUMAKI}
\index{Guard}
\index{RUMAKI!Temake}
\index{RUMAKI!Mafia}
\index{Songosongo}
\index{Mtwara}
\index{Kishe}
\index{maps}
\index{Octopus}
\index{Groups!reef fish}
\index{Groups!tuna fish}
\index{tuna}
\index{seascape}
\index{Tanga}
\index{SwioFish}
\index{Dar es Salaam}
\index{Tanzania}
\index{Mshana}
\index{fishermen}
\index{Groups!reef fish}
\index{Groups!octopus}
\index{Groups!elasmobranch}


